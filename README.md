# Proto Excel

Excelライクなテーブルエディタです。行・列の追加・削除、セルの編集、コピー＆ペースト、キーボードショートカットなどの基本的な機能を備えています。

## 機能

### 基本的なUI
- テーブルの表示と編集
- ツールバーによる操作（行・列の追加・削除、コピー・切り取り・貼り付け）
- セルの選択と編集
- ショートカットキー一覧の表示

### データ操作
- セルの編集
- 行・列の追加・削除
- コピー・切り取り・貼り付け機能
- Markdownフォーマットでのテーブルコピー

### キーボード操作
- 矢印キーによるセル移動
- Shift+矢印キーによる選択範囲の拡大
- F2またはEnterキーによる編集モード開始
- Escキーによる編集キャンセル
- Enterキーによる編集確定
- Ctrl+C/⌘+C（コピー）、Ctrl+X/⌘+X（切り取り）、Ctrl+V/⌘+V（貼り付け）
- Shift+?（ショートカットキー一覧表示）

## 技術的な実装

### コンポーネント構造
- `Table`: メインのテーブルコンポーネント
- `Cell`: 個々のセルを表示するコンポーネント
- `ShortcutHelp`: ショートカットキー一覧を表示するコンポーネント

### カスタムフック
- `useTableData`: テーブルデータの管理
- `useTableSelection`: セル選択の管理
- `useCellEditing`: セル編集の管理
- `useClipboard`: コピー＆ペースト機能の管理
- `useKeyboardEvents`: キーボードイベントの管理

### ユーティリティ
- `cellWidthCalculator`: セル幅の計算
- `markdownConverter`: テーブルデータをMarkdown形式に変換

## 使い方

### テーブルの基本操作
1. セルをクリックして選択
2. ダブルクリックまたはF2キーを押して編集モード開始
3. 編集後、Enterキーで確定またはEscキーでキャンセル

### 行・列の操作
- ツールバーの「行を追加」「行を削除」ボタンで行の追加・削除
- ツールバーの「列を追加」「列を削除」ボタンで列の追加・削除

### コピー＆ペースト
1. セルまたは範囲を選択
2. ツールバーの「コピー」ボタンまたはCtrl+C/⌘+Cでコピー
3. ツールバーの「切り取り」ボタンまたはCtrl+X/⌘+Xで切り取り
4. 貼り付け先のセルを選択
5. ツールバーの「貼り付け」ボタンまたはCtrl+V/⌘+Vで貼り付け

### Markdownとしてコピー
1. ツールバーの「Markdownコピー」ボタンをクリック
2. テーブル全体がMarkdown形式でクリップボードにコピーされる
3. 任意のテキストエディタやMarkdownエディタに貼り付けて使用

### ショートカットキー一覧
ツールバーの「ヘルプ」ボタンをクリックするか、`Shift+?`キーを押すと、利用可能なすべてのショートカットキーの一覧が表示されます。

| ショートカット | 機能 |
|--------------|------|
| Ctrl+C / ⌘+C | コピー |
| Ctrl+X / ⌘+X | 切り取り |
| Ctrl+V / ⌘+V | 貼り付け |
| Delete / Backspace | セルクリア |
| F2 / Enter | 編集開始 |
| Escape | 編集キャンセル |
| Enter (編集中) | 編集確定 |
| 矢印キー | セル移動 |
| Shift + 矢印キー | 選択範囲拡大 |
| Tab / Shift+Tab | 右/左に移動 |
| Shift+? | ショートカットキー一覧表示 |

## 開発

### 環境構築
```bash
npm install
```

### 開発サーバー起動
```bash
npm run dev
```

### テスト実行
```bash
npm test
```

### ビルド
```bash
npm run build
```