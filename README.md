# Excel-like Table Editor

シンプルなExcelライクな表エディタです。Reactで実装されており、基本的な表編集機能を提供します。

## 主な機能

### 基本的なUI
- グリッド表示（セル、行、列）
  - デフォルトで5x5のグリッド
  - 表の幅は列の合計幅に自動調整
- スクロール可能な領域
- ツールバーによる操作
- ショートカットヘルプ表示機能

### セル操作
- セルの選択（単一・複数）
  - クリックによる選択
  - ドラッグアンドドロップによる範囲選択
  - Shift+クリックによる範囲選択
  - Shift+矢印キーによる選択範囲の拡大/縮小
- セルの編集
  - ダブルクリックまたはEnterキーで編集モード開始
  - 日本語入力（IME）対応
  - Escキーでキャンセル、Enterキーで確定
- セル幅の管理
  - セルごとに個別の幅を設定可能
  - 「幅を更新」ボタンで内容に合わせて自動調整
  - 全角文字と改行を考慮した幅の計算
  - 初期表示時に自動的に幅を調整

### キーボード操作
- 矢印キーによるナビゲーション
- Tabキー（次のセル）、Shift+Tabキー（前のセル）
- Enterキー（編集開始/確定）
- Escキー（編集キャンセル）
- Delete/Backspaceキー（選択セルのクリア）
- Ctrl+C/⌘+C（コピー）
- Ctrl+X/⌘+X（カット）
- Ctrl+V/⌘+V（ペースト）
- Shift+?（ショートカットヘルプ表示）

### データ操作
- コピー＆ペースト＆カット
- 行の追加/削除
- 列の追加/削除
- 選択セルのクリア
- Markdownへの変換

## 技術的な実装

### コンポーネント構成
- `Table`: メインのテーブルコンポーネント
- `Cell`: 個々のセルを表示・編集するコンポーネント
- `ShortcutHelp`: ショートカットキーのヘルプを表示するモーダルコンポーネント

### カスタムフック
- `useTableData`: テーブルデータの管理
- `useTableSelection`: 選択状態の管理
- `useCellEditing`: セル編集の管理
- `useKeyboardEvents`: キーボードイベントの管理
- `useClipboard`: クリップボード操作の管理（コピー、カット、ペースト）

### データ構造
- 2次元配列によるセルデータの管理
- 各セルは値、編集状態、幅を保持

### ユーティリティ
- `cellWidthCalculator`: セル幅を計算するユーティリティ関数
  - 全角文字は半角の2倍の幅として計算
  - 改行を考慮して各行の最大幅を計算

## 使用方法

```jsx
import { Table } from './components/Table';

// 初期データの定義（5x5のグリッド）
const initialData = Array(5).fill(null).map(() =>
  Array(5).fill(null).map(() => ({
    value: '',
    isEditing: false,
    width: 80, // デフォルト幅
  }))
);

function App() {
  return (
    <div className="App">
      <Table initialData={initialData} />
    </div>
  );
}
```

## ショートカットキー一覧

以下のショートカットキーが使用可能です：

| ショートカット | 機能 |
|--------------|------|
| Ctrl+C / ⌘+C | コピー |
| Ctrl+X / ⌘+X | カット |
| Ctrl+V / ⌘+V | ペースト |
| Delete / Backspace | セルをクリア |
| F2 / Enter | 編集モード開始 |
| Escape | 編集キャンセル |
| Enter | 編集確定（編集モード中） |
| ↑↓←→ | セル移動 |
| Shift+↑↓←→ | 選択範囲を拡大 |
| Tab / Shift+Tab | 右/左のセルに移動 |
| Shift+? | ショートカットヘルプ表示 |

ショートカットヘルプは「Shift+?」キーを押すか、ツールバーの「ショートカット」ボタンをクリックすることで表示できます。

## Markdownへの変換

テーブルデータをMarkdown形式に変換する機能を提供しています。変換されたMarkdownは以下の形式になります：

```markdown
| セル1 | セル2 |
|-------|-------|
| セル3 | セル4 |
```

## 今後の拡張予定

- 変更履歴の管理（Undo/Redo）
- ダークモード対応
- セルのスタイリング（フォント、色、境界線など）
- 列幅・行高の調整
- データの保存と読み込み
- セル内の書式設定（太字、斜体など） 